<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‚ô†Ô∏è Black Jack Online ‚ô•Ô∏è ‚Äî Hobbyprojekt</title>
  <style>
    :root{
      --bg:#001a00;
      --panel:#142814;
      --accent:#FFD700;
      --muted:#aaa;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:var(--bg);
      color:#fff;
      font-family:Arial,Helvetica,sans-serif;
      padding:20px;
    }
    .container{
      width:100%;
      max-width:720px;
      background:var(--panel);
      border-radius:18px;
      padding:22px;
      text-align:center;
      box-shadow:0 8px 30px rgba(0,0,0,0.6);
    }
    h1{ color:var(--accent); margin:6px 0 10px; font-size:34px;}
    .card-box, .dealer-box{
      border-radius:12px;
      padding:14px;
      margin:10px 0;
      text-align:left;
    }
    .card-box{ background:#004d00 }
    .dealer-box{ background:#333333 }
    .points{ color:var(--accent); font-size:20px; margin:10px 0 16px;}
    input[type="text"]{
      width:70%;
      padding:10px;
      border-radius:8px;
      border:none;
      margin:6px 0;
      font-size:16px;
    }
    button{
      padding:10px 16px;
      margin:6px;
      font-size:15px;
      border-radius:10px;
      border:none;
      cursor:pointer;
      color:#000;
    }
    #deal{ background:#228B22 }
    #hit{ background:#0066CC }
    #stand{ background:#CC0000 }
    #resetPoints{ background:#FF8C00 }
    #leaderboardBtn{ background:#4444AA }
    #deleteAccount{ background:#882222 }
    .small{ font-size:13px; color:var(--muted) }

    /* --- Neuer, dezenter Footer --- */
    footer{
      position:fixed;
      bottom:0;
      left:0;
      width:100%;
      text-align:center;
      font-size:12px;
      color:var(--muted);
      background:rgba(0,0,0,0.4);
      padding:4px 8px;
      border-top:1px solid rgba(255,255,255,0.1);
      z-index:10;
    }
    footer button{
      background:none;
      border:none;
      color:var(--muted);
      cursor:pointer;
      font-size:12px;
      text-decoration:underline;
    }

    /* Modal */
    .modal-backdrop{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.6);
      display:none;
      align-items:center;
      justify-content:center;
      padding:20px;
      z-index:50;
    }
    .modal{
      background:#0f2610;
      border-radius:12px;
      padding:18px;
      width:100%;
      max-width:720px;
      color:#eee;
      text-align:left;
      max-height:90vh;
      overflow:auto;
    }
    .modal h3{ margin-top:0; color:var(--accent) }
    .row{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top:10px; }
    ol.leader{ text-align:left; padding-left:20px; color:#fff; }
    .tag{ display:inline-block; font-size:12px; padding:2px 8px; border-radius:12px; background:#2b2b2b; margin-left:8px; }

    @media(max-width:520px){
      input[type="text"]{ width:100% }
      .row{ flex-direction:column }
    }
  </style>
</head>
<body>

  <!-- LOGIN -->
  <div class="container" id="loginScreen">
    <h1>‚ô†Ô∏è Black Jack Online ‚ô•Ô∏è</h1>
    <p class="small">Dieses Projekt ist ein <b>privates Hobbyprojekt</b> ‚Äî keine echten Eins√§tze oder Gewinne m√∂glich.</p>

    <h3 style="color:#fff">üîê Anmelden / Registrieren</h3>
    <input id="username" placeholder="Benutzername (lokal gespeichert)">
    <div class="row">
      <button id="loginBtn">Anmelden / Registrieren</button>
    </div>

    <p class="small" style="margin-top:12px;">
      Hinweis: Benutzername & Punkte werden <b>nur lokal im Browser (localStorage)</b> gespeichert. Es findet <b>keine √úbertragung</b> an Dritte statt.
    </p>
  </div>

  <!-- SPIEL -->
  <div class="container" id="gameScreen" style="display:none;">
    <h1>‚ô†Ô∏è Black Jack Online ‚ô•Ô∏è</h1>
    <p id="welcomeUser" style="font-size:16px;color:var(--accent)"></p>
    <p id="message">üé≤ Dr√ºcke 'Deal', um zu starten!</p>

    <div class="card-box" id="player-box">üßç Spieler: -</div>
    <div class="dealer-box" id="dealer-box" style="display:none">ü§ñ Dealer:</div>

    <div class="points" id="points">üí∞ Punkte: 100</div>

    <div class="row" style="justify-content:center">
      <button id="deal">Deal</button>
      <button id="hit">Hit</button>
      <button id="stand">Stand</button>
    </div>

    <div class="row" style="margin-top:8px">
      <button id="resetPoints">üîÑ Punkte auf 100 zur√ºcksetzen</button>
      <button id="leaderboardBtn">üèÜ Bestenliste</button>
      <button id="deleteAccount">üóëÔ∏è Konto l√∂schen</button>
      <button id="logoutBtn">üö™ Abmelden</button>
    </div>

    <p class="small" style="margin-top:10px;">
      Keine echten Eins√§tze oder Preise. Nur Unterhaltung. Betreiber: Privates Hobbyprojekt.
    </p>
  </div>

  <!-- LEADERBOARD -->
  <div class="container" id="leaderboardScreen" style="display:none;">
    <h1>üèÜ Bestenliste</h1>
    <div id="leaderboard"></div>
    <div class="row" style="margin-top:12px">
      <button id="backToGame">‚¨ÖÔ∏è Zur√ºck</button>
    </div>
  </div>

  <!-- MODAL: Impressum & Datenschutz -->
  <div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-hidden="true">
    <div class="modal" role="document">
      <h3>Impressum & Datenschutz</h3>
      <p><b>Betreiber:</b> Hannes Gabriel G√ºnther<br>
      <b>Adresse:</b> D√∂rnfeld an der Heide 54F 07426 K√∂nigsee<br>
      <b>Kontakt:</b> hg.koenigsee@gmail.com<br>
      <b>Nutzung:</b> rein privat, nicht kommerziell.</p>

      <h4>Rechtlicher Hinweis</h4>
      <p>
        Dieses Spiel ist ein <b>reines Unterhaltungsprojekt</b>. Es werden <b>keine echten Eins√§tze</b> akzeptiert und <b>keine echten Gewinne</b> ausgezahlt.
      </p>

      <h4>Datenschutz</h4>
      <ul>
        <li>Nur lokale Speicherung (Benutzername & Punkte im Browser).</li>
        <li>Keine Server, keine Cookies, keine externe √úbertragung.</li>
        <li>Daten l√∂schbar √ºber ‚ÄûKonto l√∂schen‚Äú oder Browser-Cache.</li>
      </ul>

      <div style="text-align:center; margin-top:12px;">
        <button id="closeModal">Schlie√üen</button>
      </div>
    </div>
  </div>

  <!-- Dezenter Footer -->
  <footer>
    ¬© Privates Hobbyprojekt ‚Äî kein Echtgeld ¬∑ 
    <button id="openImpressumFooter">Impressum & Datenschutz</button>
  </footer>

  <script>
    // --- Grundlogik / Spielvariablen ---
    let playerHand = [], dealerHand = [], points = 100, currentUser = null, standBlocked = false;
    const fullDeck = [2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11];
    let cards = [...fullDeck];

    function saveUsersToStorage(users){ localStorage.setItem("blackjackUsers", JSON.stringify(users)); }
    function loadUsersFromStorage(){ return JSON.parse(localStorage.getItem("blackjackUsers") || "{}"); }
    function drawCard(){ if(cards.length===0) cards=[...fullDeck]; const i=Math.floor(Math.random()*cards.length); return cards.splice(i,1)[0]; }
    function sum(h){ return h.reduce((a,b)=>a+b,0); }

    const loginScreen=document.getElementById("loginScreen"),
          gameScreen=document.getElementById("gameScreen"),
          leaderboardScreen=document.getElementById("leaderboardScreen"),
          message=document.getElementById("message"),
          dealerBox=document.getElementById("dealer-box"),
          playerBox=document.getElementById("player-box"),
          pointsBox=document.getElementById("points"),
          welcomeUser=document.getElementById("welcomeUser");

    document.getElementById("loginBtn").onclick=function(){
      const name=document.getElementById("username").value.trim();
      if(!name){alert("Bitte gib einen Benutzernamen ein.");return;}
      const safe=name.replace(/</g,"&lt;").replace(/>/g,"&gt;").slice(0,30);
      let users=loadUsersFromStorage();
      if(!users[safe]) users[safe]={points:100};
      saveUsersToStorage(users);
      currentUser=safe; points=users[safe].points;
      showGameScreen();
    };

    function showGameScreen(){
      loginScreen.style.display="none";
      leaderboardScreen.style.display="none";
      gameScreen.style.display="block";
      welcomeUser.textContent=`üëã Willkommen, ${currentUser} ‚Äî (Hobbyprojekt)`;
      updateUI();
    }

    document.getElementById("logoutBtn").onclick=function(){
      currentUser=null; playerHand=[]; dealerHand=[];
      gameScreen.style.display="none"; loginScreen.style.display="block";
    };

    document.getElementById("deal").onclick=function(){
      if(points<10){message.textContent="‚ö†Ô∏è Zu wenig Punkte.";return;}
      standBlocked=false; points-=10; cards=[...fullDeck];
      playerHand=[drawCard(),drawCard()]; dealerHand=[drawCard(),drawCard()];
      dealerBox.style.display="none"; message.textContent="Neue Runde! üçÄ";
      updateUI();
    };
    document.getElementById("hit").onclick=function(){
      if(playerHand.length===0){message.textContent="Dr√ºcke zuerst Deal.";return;}
      playerHand.push(drawCard()); updateUI();
      if(sum(playerHand)>21) message.textContent="üí• Bust!";
    };
    document.getElementById("stand").onclick=function(){
      if(standBlocked||playerHand.length===0){message.textContent="Dr√ºcke zuerst Deal.";return;}
      standBlocked=true; while(sum(dealerHand)<17) dealerHand.push(drawCard());
      const ps=sum(playerHand), ds=sum(dealerHand);
      if(ds>21) message.textContent="üèÜ Dealer bust! Du gewinnst!";
      else if(ps>21) message.textContent="üí• Bust!";
      else if(ps>ds) message.textContent="üéâ Du gewinnst!";
      else if(ps<ds) message.textContent="‚ùå Dealer gewinnt.";
      else message.textContent="ü§ù Unentschieden!";
      if(ps<=21){ if(ds>21||ps>ds) points+=20; else if(ps===ds) points+=10; }
      dealerBox.textContent=`ü§ñ Dealer: ${dealerHand.join(", ")} (Summe: ${ds})`;
      dealerBox.style.display="block"; updateUI();
    };

    function updateUI(){
      playerBox.textContent=`üßç Spieler: ${playerHand.join(", ")} (Summe: ${sum(playerHand)||0})`;
      pointsBox.textContent=`üí∞ Punkte: ${points}`; saveCurrentUserPoints();
    }
    function saveCurrentUserPoints(){
      if(!currentUser)return;
      const users=loadUsersFromStorage();
      if(users[currentUser]){users[currentUser].points=points; saveUsersToStorage(users);}
    }

    document.getElementById("resetPoints").onclick=function(){
      if(confirm("Punkte auf 100 zur√ºcksetzen?")){points=100;updateUI();}
    };

    document.getElementById("leaderboardBtn").onclick=function(){
      gameScreen.style.display="none"; leaderboardScreen.style.display="block"; showLeaderboard();
    };
    document.getElementById("backToGame").onclick=function(){
      leaderboardScreen.style.display="none"; showGameScreen();
    };
    function showLeaderboard(){
      const users=loadUsersFromStorage();
      const sorted=Object.entries(users).sort((a,b)=>b[1].points-a[1].points);
      let html="<ol class='leader'>";
      sorted.forEach(([n,d],i)=>{
        let medal=i===0?"ü•á":i===1?"ü•à":i===2?"ü•â":"";
        html+=`<li><strong>${n}</strong> ‚Äî ${d.points} Punkte ${medal}</li>`;
      });
      html+="</ol><p class='small'>Hinweis: lokale Bestenliste (nur dieses Ger√§t).</p>";
      document.getElementById("leaderboard").innerHTML=html;
    }

    document.getElementById("deleteAccount").onclick=function(){
      if(!currentUser)return;
      if(confirm("Lokales Konto l√∂schen?")){let u=loadUsersFromStorage();delete u[currentUser];saveUsersToStorage(u);
        currentUser=null;playerHand=[];dealerHand=[];points=100;gameScreen.style.display="none";loginScreen.style.display="block";}
    };

    // Modal-Steuerung
    const modal=document.getElementById("modalBackdrop");
    function openModal(){modal.style.display="flex";}
    function closeModal(){modal.style.display="none";}
    document.getElementById("openImpressumFooter").onclick=openModal;
    document.getElementById("closeModal").onclick=closeModal;
    modal.addEventListener("click",e=>{if(e.target===modal)closeModal();});
  </script>
</body>
</html>
